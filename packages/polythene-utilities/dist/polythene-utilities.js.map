{"version":3,"file":"polythene-utilities.js","sources":["../src/webfont-loader.js","../src/easing.js","../src/scroll-to.js","../src/timer.js"],"sourcesContent":["import { isServer, emit } from \"polythene-core\";\n\nexport const addWebFont = (vendor, config) => {\n  if (isServer) return;\n  if (!window[\"WebFontConfig\"]) {\n    /**\n     * @param {object} params\n     * @param {string} [params.name]\n     * @param {string} [params.familyName]\n     * @param {any} [params.fvd]\n     */\n    const emitEvent = ({ name, familyName, fvd }) => \n      emit(\"webfontloader\", { name, familyName, fvd, vendor, config });\n    window[\"WebFontConfig\"] = {\n      loading:      ()                => emitEvent({ name: \"loading\" }),\n      active:       ()                => emitEvent({ name: \"active\" }),\n      inactive:     ()                => emitEvent({ name: \"inactive\" }),\n      fontloading:  (familyName, fvd) => emitEvent({ name: \"fontloading\", familyName, fvd }),\n      fontactive:   (familyName, fvd) => emitEvent({ name: \"fontactive\", familyName, fvd }),\n      fontinactive: (familyName, fvd) => emitEvent({ name: \"fontinactive\", familyName, fvd }),\n    };\n    (function() {\n      const wf = document.createElement(\"script\");\n      wf.src = (document.location.protocol === \"https:\" ? \"https\" : \"http\") + \"://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js\";\n      wf.type = \"text/javascript\";\n      wf.async = true;\n      const s = document.getElementsByTagName(\"script\")[0];\n      if (s && s.parentNode) {\n        s.parentNode.insertBefore(wf, s);\n      }\n    })();\n  }\n  const vendorCfg = window[\"WebFontConfig\"][vendor] || {};\n  if (config) {\n    Object.assign(vendorCfg, config);\n  }\n  window[\"WebFontConfig\"][vendor] = vendorCfg;\n};\n","/*\nhttps://gist.github.com/gre/1650294\nEasing Functions - inspired from http://gizma.com/easing/\nOnly considering the t value for the range [0, 1] => [0, 1]\n*/\n\nexport const easing = {\n  // no easing, no acceleration\n  linear: t => t,\n  // accelerating from zero velocity\n  easeInQuad: t => t * t,\n  // decelerating to zero velocity\n  easeOutQuad: t => t * (2 - t),\n  // acceleration until halfway, then deceleration\n  easeInOutQuad: t => t < .5 ? 2 * t * t : -1 + (4 - 2 * t) * t,\n  // accelerating from zero velocity\n  easeInCubic: t => t * t * t,\n  // decelerating to zero velocity\n  easeOutCubic: t => (--t) * t * t + 1,\n  // acceleration until halfway, then deceleration\n  easeInOutCubic: t => t < .5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1,\n  // accelerating from zero velocity\n  easeInQuart: t => t * t * t * t,\n  // decelerating to zero velocity\n  easeOutQuart: t => 1 - (--t) * t * t * t,\n  // acceleration until halfway, then deceleration\n  easeInOutQuart: t => t < .5 ? 8 * t * t * t * t : 1 - 8* (--t) * t * t * t,\n  // accelerating from zero velocity\n  easeInQuint: t => t * t * t * t * t,\n  // decelerating to zero velocity\n  easeOutQuint: t => 1 + (--t) * t * t * t * t,\n  // acceleration until halfway, then deceleration\n  easeInOutQuint: t => t < .5 ? 16 * t * t * t * t * t : 1 + 16 * (--t) * t * t * t * t\n};\n","/*\n Animated scroll to a position.\n Derived from https://github.com/madebysource/animated-scrollto\n Adapted to Mithril and rewritten to es6.\n*/\n\nimport { easing } from \"./easing\";\nimport { isServer } from \"polythene-core\";\n\nexport const scrollTo = opts => {\n  if (isServer) {\n    return;\n  }\n  const element = opts.element;\n  const which = (opts.direction === \"horizontal\") ? \"scrollLeft\" : \"scrollTop\";\n  const to = opts.to;\n  const duration = opts.duration * 1000;\n  const easingFn = opts.easing || easing.easeInOutCubic;\n  const start = element[which];\n  const change = to - start;\n  const animationStart = new Date().getTime();\n  let animating = true;\n  return new Promise(resolve => {\n    const animateScroll = () => {\n      if (!animating) {\n        return;\n      }\n      requestAnimFrame(animateScroll);\n      const now = new Date().getTime();\n      const percentage = ((now - animationStart) / duration);\n      const val = start + change * easingFn(percentage);\n      element[which] = val;\n      if (percentage >= 1) {\n        element[which] = to;\n        animating = false;\n        resolve();\n      }\n    };\n    requestAnimFrame(animateScroll);\n  });\n};\n\nconst requestAnimFrame = isServer\n  ? () => {}\n  : (() =>\n    window.requestAnimationFrame || window.webkitRequestAnimationFrame || window[\"mozRequestAnimationFrame\"] || (callback =>\n      window.setTimeout(callback, 1000 / 60)\n    )\n  )();\n","// @ts-check\n\nimport { isClient } from \"polythene-core\";\n\nexport const Timer = function() {\n\n  /** @type {number} */\n  let timerId;\n\n  /** @type {number} */\n  let startTime;\n\n  /** @type {number} */\n  let remaining;\n\n  /** @type {() => any} */\n  let cb;\n\n  const stop = () => {\n    if (isClient) {\n      window.clearTimeout(timerId);\n    }\n  };\n\n  const pause = () => (\n    stop(),\n    remaining -= new Date().getTime() - startTime\n  );\n\n  const startTimer = () => {\n    if (isClient) {\n      stop();\n      startTime = new Date().getTime();\n      timerId = window.setTimeout(cb, remaining);\n    }\n  };\n\n  const start = (callback, duration) => (\n    cb = callback,\n    remaining = duration * 1000,\n    startTimer()\n  );\n\n  const resume = () =>\n    startTimer();\n\n  return {\n    start,\n    pause,\n    resume,\n    stop\n  };\n};\n"],"names":["addWebFont","vendor","config","isServer","window","emitEvent","name","familyName","fvd","emit","loading","active","inactive","fontloading","fontactive","fontinactive","wf","document","createElement","src","location","protocol","type","async","s","getElementsByTagName","parentNode","insertBefore","vendorCfg","easing","linear","t","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","scrollTo","opts","element","which","direction","to","duration","easingFn","start","change","animationStart","Date","getTime","animating","Promise","resolve","animateScroll","requestAnimFrame","now","percentage","val","requestAnimationFrame","webkitRequestAnimationFrame","callback","setTimeout","Timer","timerId","startTime","remaining","cb","stop","isClient","clearTimeout","pause","startTimer","resume"],"mappings":"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"}