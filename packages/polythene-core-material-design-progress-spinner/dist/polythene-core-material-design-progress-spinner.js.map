{"version":3,"file":"polythene-core-material-design-progress-spinner.js","sources":["../../polythene-css-classes/material-design-progress-spinner.js","../src/spinner.js"],"sourcesContent":["\nexport default {\n  component:          \"pe-md-progress-spinner\",\n\n  // elements\n  animation:          \"pe-md-progress-spinner__animation\",\n  circle:             \"pe-md-progress-spinner__circle\",\n  circleRight:        \"pe-md-progress-spinner__circle-right\",\n  circleLeft:         \"pe-md-progress-spinner__circle-left\"\n};\n","import { unpackAttrs, getStyle, styleDurationToMs } from \"polythene-core\";\nimport { easing } from \"polythene-utilities\";\nimport classes from \"polythene-css-classes/material-design-progress-spinner\";\n\nconst percentageValue = (min, max, percentage = 0) => min + ((max - min) * percentage);\n\nconst rotateCircle = (el, min, max, percentage) => {\n  const style = el.style;\n  style[\"transform\"] =\n    style[\"-webkit-transform\"] =\n    style[\"-moz-transform\"] =\n    style[\"-ms-transform\"] =\n    style[\"-o-transform\"] = \"rotate(\" + percentageValue(min, max, percentage) + \"deg)\";\n};\n\nconst animate = (stateEl, size, percentage) => {\n  const animationEl = stateEl.querySelector(\".\" + classes.animation);\n  const animationElStyle = animationEl.style;\n  if (percentage < 0.5) {\n    animationElStyle.clip = \"rect(0px, \" + size + \"px, \" + size + \"px, \" + size / 2 + \"px)\";\n  } else {\n    animationElStyle.clip = \"rect(auto, auto, auto, auto)\";\n  }\n  const leftCircle = stateEl.querySelector(\".\" + classes.circleLeft);\n  const rightCircle = stateEl.querySelector(\".\" + classes.circleRight);\n  leftCircle.style.clip = rightCircle.style.clip = \"rect(0px, \" + size / 2 + \"px, \" + size + \"px, \" + \"0px)\";\n  rotateCircle(rightCircle, 0, 180, Math.min(1, percentage * 2));\n  rotateCircle(leftCircle, 0, 360, percentage);\n};\n\nconst updateWithPercentage = ({ state, attrs, size }) => {\n  if (!state.dom) {\n    return;\n  }\n  if (state.animating()) {\n    return;\n  }\n  if (attrs.percentage === undefined) {\n    return;\n  }\n  const percentage = unpackAttrs(attrs.percentage);\n  const previousPercentage = state.percentage();\n  const easingFn = attrs.animated\n    ? easing.easeInOutQuad\n    : v => v;\n  if (attrs.animated && previousPercentage !== percentage) {\n    const el = state.dom;\n    const animationDuration = attrs.updateDuration !== undefined\n      ? attrs.updateDuration * 1000\n      : styleDurationToMs(getStyle({ element: el.querySelector(`.${classes.animation}`), prop: \"animation-duration\" }));\n    let start = null;\n    const step = timestamp => {\n      if (!start) start = timestamp;\n      const progress = timestamp - start;\n      const stepPercentage = 1.0 / animationDuration * progress;\n      const newPercentage = previousPercentage + stepPercentage * (percentage - previousPercentage);\n      animate(el, size, easingFn(newPercentage));\n      if (start && progress < animationDuration) {\n        window.requestAnimationFrame(step);\n      } else {\n        start = null;\n        state.percentage(percentage);\n        state.animating(false);\n      }\n    };\n    state.animating(true);\n    window.requestAnimationFrame(step);\n  } else {\n    animate(state.dom, size, easingFn(percentage));\n    state.percentage(percentage);\n  }\n};\n\nconst getSize = element => \n  Math.round(\n    element\n      ? parseFloat(getStyle({ element, prop: \"height\" })) - 2 * parseFloat(getStyle({ element, prop: \"padding\" }))\n      : 0\n  );\n\nexport const getInitialState = (vnode, createStream) => {\n  const percentage = createStream(0);\n  const animating = createStream(false);\n  return {\n    animating,\n    dom: undefined,\n    percentage,\n    redrawOnUpdate: createStream.merge([animating])\n  };\n};\n\nexport const onMount = vnode => {\n  if (!vnode.dom) {\n    return;\n  }\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  state.dom = vnode.dom;\n  const size = getSize(state.dom);\n  updateWithPercentage({ state, attrs, size });\n};\n\nexport const createProps = (vnode, { renderer: h }) => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  const size = getSize(state.dom);\n  updateWithPercentage({ state, attrs, size });\n\n  const content = h(\"div\",\n    {\n      key: \"content\",\n      className: classes.animation,\n      style: {\n        width: size + \"px\",\n        height: size + \"px\"\n      }\n    },\n    [\n      h(\"div\", {\n        key: \"left\",\n        className: [classes.circle, classes.circleLeft].join(\" \")\n      }),\n      h(\"div\", {\n        key: \"right\",\n        className: [classes.circle, classes.circleRight].join(\" \")\n      })\n    ]\n  );\n\n  return Object.assign(\n    {},\n    attrs,\n    {\n      className: [classes.component, attrs.className].join(\" \"),\n      content\n    }\n  );\n};\n"],"names":["component","animation","circle","circleRight","circleLeft","percentageValue","min","max","percentage","rotateCircle","el","style","animate","stateEl","size","animationEl","querySelector","classes","animationElStyle","clip","leftCircle","rightCircle","Math","updateWithPercentage","state","attrs","dom","animating","undefined","unpackAttrs","previousPercentage","easingFn","animated","easing","easeInOutQuad","v","animationDuration","updateDuration","styleDurationToMs","getStyle","element","prop","start","step","timestamp","progress","stepPercentage","newPercentage","window","requestAnimationFrame","getSize","round","parseFloat","getInitialState","vnode","createStream","redrawOnUpdate","merge","onMount","createProps","h","renderer","content","key","className","width","height","join"],"mappings":"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"}